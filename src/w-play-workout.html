<!--
@license
Copyright (c) 2017 Peter Kaske
-->

<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/polymer/lib/mixins/gesture-event-listeners.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="w-slide-up-panel.html">
<link rel="import" href="view-mixin.html">
<link rel="import" href="helpers-mixin.html">
<link rel="import" href="shared-styles.html">

<dom-module id="w-play-workout">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
      }

      header {
        background: var(--pc-600);
        @apply --layout-horizontal;
        @apply --layout-justified;
        @apply --layout-center;
        background: var(--pc-600);
        padding: 10px;
      }

      header > div:first-child {
        @apply --layout-flex;
      }

      header iron-icon {
        color: var(--gold);
        margin-left: 10px;
      }

      .pr-gold {
        color: var(--gold);
      }

      .content {
        padding: 10px;
        background: var(--pc-800);
      }

      .set-no {
        color: var(--pc-100);
        font-weight: bold;
      }
    </style>

    <w-slide-up-panel full id="panel">
      <paper-icon-button icon="wi:arrow-back" slot="header-left" dismiss-panel></paper-icon-button>
      <h1 slot="header">[[_session.name]]</h1>

      <template is="dom-repeat" items="[[_exerciseData(_session.exercises.*, exercisesMap)]]" as="ex">
        <section class="margin-top-25">
          <header>
            <div>[[ex.name]]</div>
            <div class="pr-gold">40 kg</div>
            <iron-icon icon="wi:trophy"></iron-icon>
          </header>
          <div class="content">
            <template is="dom-repeat" items="[[_getSets(ex)]]" as="set">
              <div class="horizontal justified">
                <div class="set-no">[[set]]</div>
              </div>
            </template>
          </div>
        </section>
      </template>
    </w-slide-up-panel>
  </template>

  <script>
    class WPlayWorkout extends Polymer.GestureEventListeners(HelpersMixin(ViewMixin(Polymer.Element))) {
      static get is() { return 'w-play-workout'; }

      static get properties() {
        return {
          exercisesMap: {
            type: Map
          },

          _session: {
            type: Object
          }
        };
      }

      start(session) {
        this._session = session;
        this.$.panel.show();
      }

      _exerciseData() {
        if (this._session) {
          return this._resolveExercises(this._session.exercises);
        }
      }

      _getSets(ex) {
        return [...Array(ex.sets).keys()].slice(1);
      }
    }

    window.customElements.define(WPlayWorkout.is, WPlayWorkout);
  </script>
</dom-module>
